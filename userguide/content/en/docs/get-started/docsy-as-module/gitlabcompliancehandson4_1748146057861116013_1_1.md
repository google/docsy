---
title: "GitLab Compliance - Hands-On Lab: Enable and Configure License Compliance"
description: "This Hands-On Guide walks you through enabling and using License Compliance in a GitLab project."
---

> Estimated time to complete: 15 minutes

## Objectives

When you add new dependencies to a project, you need to carefully consider how the licenses of the dependencies impact the project. To ensure that license requirements are met, you can add a policy to require approval for newly detected licenses.

In addition to scanning dependencies for vulnerabilities, the dependency scanner will also record the license that each dependency uses.

The License Compliance report will generate a list of all of the licenses detected in the project that are out of compliance with the project policies.

## Task A. Setting up Your Project

Before we start using license compliance scans, it is helpful to have some licenses setup in our project.

1. Navigate to your project.

1. Select **+ > New file**.

1. In the **Filename**, type `requirements.txt`

1. In the contents, add the following text:

    ```python
    #
    # This file is autogenerated by pip-compile with Python 3.12 by the following command:
    #
    #    pip-compile --output-file=requirements.txt requirements.in
    #
    requests==2.27.1
    ```

1. In the **Target Branch** field, enter the name `add-deps`.

1. Ensure that **Start a new Merge Request with these changes** is checked.

1. Select **Commit changes**.

1. Leave all options in the Merge Request as default and select **Create Merge Request**.

1. Select **Merge**.

1. In the left sidebar, select **Code > Repository**.

1. Select **+ > New file**.

1. Name the file `.gitlab-ci.yml`.

1. Add the following contents to the file:

    ```yml
    stages:
        - test
    include:
      - component: ilt.gitlabtraining.cloud/components/dependency-scanning/main@main
    ```

1. Set the **Target Branch** to `add-scans`.

1. Ensure that **Start a new Merge Request with these changes** is checked.

1. Select **Commit changes**.

1. Leave all options as default and select **Create Merge Request**.

1. Select **Merge**.

These changes have added dependency scanning and dependencies to your application. With these changes, you will now be able to view your project licenses and control license compliance.

## Task B. License Compliance Scans

1. Navigate to **Secure > Dependency list**.

1. Click any of the licenses to view more details about the license and the compliance requirements.

## Task C. Approve and Deny Licenses

> Let's assume that your team has approved the MIT license. If any license aside from the MIT license exists in a dependency, it must be approved before the Merge Request can be complete.

1. Navigate to **Secure > Policies**.

1. Click the **New policy** button.

1. Click **Merge Request approval policy > Select policy**.

1. Input any name (ex. `ScanApprovedPolicy`) and description for the policy.

1. Set the **Policy status** to **Enabled**.

1. In **Rules**, set the **Select scan type** dropdown menu to **License Scan**. Ensure that `all protected branches` with `No exceptions` is selected for the Merge Request target.

1. Set the **Status is** dropdown menu to **Newly Detected**.

1. Set the first dropdown in the **License is** section to **Except**.

    > To exit the multi-select dropdown, click anywhere outside of it.

1. In the **Select license types** dropdown, click `MIT License`. There are several licenses with similar names, so be sure to pick the right one.

1. In the **Actions** section, require 1 approval from an individual user. Click your username as the approval user.

1. Leave the **Override project approval settings** checkboxes selected and click **Configure with a Merge Request**.

1. In the resulting Merge Request, click the **Merge** button.

1. When you create a policy, GitLab will create a new project for managing the policies. After you click **Merge**, you will need to navigate back to your original project.

## Task D. View the License Compliance report for a pipeline

1. In the left sidebar, select **Build > Pipelines**.

1. Select the **Run pipeline** button at the top right of the page.

1. Leave all of the options at their default values, then select **Run pipeline**.

1. Monitor your pipeline and wait for each job to complete successfully.

1. Once all of the jobs are complete, refresh the page. Select the **Licenses** tab.

1. Notice that GitLab now describes every license except the **MIT License** as a policy violation. This report helps to flag existing dependencies which may contain licenses that you have not approved.

## Task E. Create an MR that adds a dependency with a denied license

1. Create a new branch named `add-dnspython-dependency`.

1. Add a new dependency to the `add-dnspython-dependency` branch **(not the `main` branch!)** by pasting `dnspython==2.1.0` as a new line at the end of `requirements.txt`.

1. Click the **Create Merge Request** button.

1. Leave all fields as their default values and click **Create Merge Request**.

1. Wait for the pipeline for the Merge Request to complete.

1. Once the pipeline completes, refresh the page. A license compliance scan will now display, showing 1 new license detected.

1. Return to the Merge Request overview.

1. Click **Full report**.

1. The license compliance report will list all of the licenses that are no longer in compliance with the project policy. Note that the merge status will appear stating **Requires 1 approval from policy**.

1. A new comment is also added to the activity of the Merge Request, stating that a policy violation was detected.

    > This Merge Request now requires additional approval because `dnspython` does not use an approved license. A reviewer can now verify if the license is ok to proceed with before the merge is complete.

## Task F. Lab Policy Cleanup

> To ensure that you can merge branches into main without approval, it is best to disable the policy.

1. Navigate to **Secure > Policies**.

2. Click on the policy you created. Click **Edit policy**.

3. Click **Delete Policy**.

4. Click **Merge** on the resulting Merge Request.

## Lab Guide Complete

You have completed this lab exercise. You can view the other [lab guides for this course](/handbook/customer-success/professional-services-engineering/education-services/ilt-labs/gitlabcompliancehandson).

## Suggestions?

If you'd like to suggest changes to the *Hands-On Guide for GitLab Compliance*, please submit them via Merge Request.
